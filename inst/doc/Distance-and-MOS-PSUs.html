<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="George Zipf, Richard Valliant" />

<meta name="date" content="2025-04-25" />

<title>Creating Geography-Based PSUs with as Similarly-Sized MOS as Possible</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">

div.csl-bib-body { }
div.csl-entry {
clear: both;
margin-bottom: 0em;
}
.hanging div.csl-entry {
margin-left:2em;
text-indent:-2em;
}
div.csl-left-margin {
min-width:2em;
float:left;
}
div.csl-right-inline {
margin-left:2em;
padding-left:1em;
}
div.csl-indent {
margin-left: 2em;
}
</style>

<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Creating Geography-Based PSUs with as
Similarly-Sized MOS as Possible</h1>
<h4 class="author">George Zipf, Richard Valliant</h4>
<h4 class="date">2025-04-25</h4>



<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: { equationNumbers: { autoNumber: "AMS" } }
});
</script>
<p>In a survey population of geographic sampling units, it may be
required that a sampling frame of primary sampling units (PSUs) be
developed where geographic sampling units are combined. This is
particularly true in two-stage sample designs, where central geographic
units may be chosen for a team of survey researchers to visit and
secondary stage sampling units (SSUs), e.g.Â households, schools, or
businesses, are the units of interest. In this vignette, we review how
to use the GeoDistPSU and GeoDistMOS functions in the PracTools package
to create a sampling frame of geography-based PSUs and show an example.
We provide some guidelines in defining PSUs, how to display the United
States geography-based PSUs with maps, and also show how the results of
geography-based sample frame can be integrated with two-stage sample
size calculations.</p>
<div id="guidelines-for-creating-geography-based-psus" class="section level2">
<h2>Guidelines for Creating Geography-Based PSUs</h2>
<p>The following are useful guidelines for creating geography-based
PSUs.</p>
<ol style="list-style-type: decimal">
<li><strong>Political Boundaries</strong>. There are many situations
where it makes sense to use political boundaries, e.g.Â states or
counties, to separate geographic sampling units. <em>GeoDistPSU does not
separate sampling units based on political boundaries.</em> If this step
is necessary, it may make sense to split the data into politically-based
data sets and apply GeoDistPSU on each politically bounded data set
accordingly.</li>
<li><strong>Maximum Distance</strong>. The area of a geography-based PSU
should not exceed a maximum distance. This parameter can be used to
limit the amount of within-PSU traveling that a data collector must do.
Maximum distance is a required setting in GeoDistPSU. The user must
select between âmilesâ and âkmsâ (kilometers) for the distance
metric.</li>
<li><strong>Measure of Size (MOS)</strong>. The MOS can be different
quantities depending on the application, e.g., number of housing units
or persons for a household survey or total dollar amount of accounts in
an auditing sample. Ideally, each geography-based PSU would have a
similar measure of size for sample selection purposes. In practice,
there are likely to be geographic units whose MOSâs are so large that
the units are certainties. However, it is sometimes possible to split
certainties into smaller geography-based PSUs. GeoDistMOS splits
extremely large PSUs based on a user-defined MOS take-all
threshold.</li>
</ol>
</div>
<div id="data-requirements-for-geography-based-psus" class="section level2">
<h2>Data Requirements for Geography-Based PSUs</h2>
<p>GeoDistPSU requires that each geographic sampling unit contain a
specific longitude and latitude in decimal format. Where the geographic
sampling units are areas larger than a specific location, e.g.Â counties
or census enumeration areas, then a specific longitude and latitude must
be selected. Typically, the specific longitude and latitude is the
centroid for the geographic sampling unit. However, other considerations
may include importance of political entities such as capitals or other
centers of government, population densities within the geographic
sampling area, whether the geographic center of the sampling area is
appropriate, etc.</p>
<p>GeoDistMOS requires a Measure of Size variable and a threshold value
above which a geography-based PSU is a certainty.</p>
</div>
<div id="process-for-creating-geography-based-psus" class="section level2">
<h2>Process for Creating Geography-Based PSUs</h2>
<p>The process for creating geography-based PSUs with similar MOSâs is
as follows:</p>
<ol style="list-style-type: decimal">
<li><strong>Ensure each geographic sampling unit has a longitude and
latitude in decimal format.</strong> If the longitude and/or latitude
are character or missing, the function will not work. It is recommended
that the data be plotted or otherwise reviewed prior to creating
geography-based PSUs as errors in geocoding can occur. If the data does
not have the longitude and latitude coordinates, the R package
tidygeocoder can be used to perform geocoding. The vignette for the
tidygeocoder package, <span class="citation">(Cambon et al.
2021)</span>, provides an overview on how to use it. Again, check the
results of tidygeocoder to ensure that all geographic sampling units
have the correct latitude and longitude before using the GeoDistPSU
function.</li>
<li><strong>Use GeoDistPSU function</strong>. The GeoDistPSU function
requires the following: Longitude, Latitude, a switch for either âmilesâ
or âkmsâ (kilometers), and a maximum within-PSU distance value.
GeoDistPSU output two data frames. The data frame PSU.ID provides the
geography=based PSU (psuID) and the Input.ID for merging to the original
input file if there is one. The other data frame, PSU.Info, contains
geography-based PSU-level information. For example, output from this
data frame can create a plot of the PSU centroids. A histogram of the
maximum within-PSU distance can also provide useful information to the
survey practitioner.</li>
<li><strong>If the sample design is probability proportional to size
(pps), then it may be useful to apply the GeoDistMOS function</strong>.
The GeoDistMOS function requires the following: Longitude, Latitude, PSU
ID, the sample size, the MOS variable, and the threshold value for
certainties. The threshold value is a probability in the range (0, 1];
PSUs with a selection probability greater than or equal to the threshold
are certainties. <em>It is assumed that the sampling units in a PSU ID
already are within the maximum PSU distance.</em> If the PSU ID is taken
from GeoDistPSU, then this is guaranteed. It is recommended that a
histogram of the final MOS be reviewed.</li>
</ol>
</div>
<div id="example" class="section level2">
<h2>Example</h2>
<p>The data set Test_Data_US comes from the US Department of
Transportation. Test_Data_US already has the longitude and latitude in
decimal format. The amount variable will be used for the MOS part of the
example. To create geography-based PSUs that have a maximum distance of
100 miles, the code is:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="fu">library</span>(PracTools)</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="fu">data</span>(Test_Data_US)</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a><span class="fu">GeoDistPSU</span>(Test_Data_US<span class="sc">$</span>lat, Test_Data_US<span class="sc">$</span>long, <span class="st">&quot;miles&quot;</span>, <span class="dv">100</span>, <span class="at">Input.ID =</span> Test_Data_US<span class="sc">$</span>ID)</span></code></pre></div>
<p>If the GeoDistPSU function is saved to an object, then a plot of the
centroids and a histogram of the maximum distances may be generated. To
do that, the code is:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="fu">GeoDistPSU</span>(Test_Data_US<span class="sc">$</span>lat, Test_Data_US<span class="sc">$</span>long, <span class="st">&quot;miles&quot;</span>, <span class="dv">100</span>, <span class="at">Input.ID =</span> Test_Data_US<span class="sc">$</span>ID)</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a><span class="fu">plot</span>(g<span class="sc">$</span>PSU.Info<span class="sc">$</span>PSU.Mean.Longitude, </span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a>     g<span class="sc">$</span>PSU.Info<span class="sc">$</span>PSU.Mean.Latitude,</span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a>     <span class="at">pch  =</span> <span class="dv">19</span>,</span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Plot of PSU Centers&quot;</span>,</span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Longitude&quot;</span>,</span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;Latitude&quot;</span>)</span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a><span class="fu">grid</span>(<span class="at">col =</span> <span class="st">&quot;grey40&quot;</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" style="display: block; margin: auto auto auto 0;" /></p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a><span class="fu">hist</span>(g<span class="sc">$</span>PSU.Info<span class="sc">$</span>PSU.Max.Dist,</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Histogram of Maximum Within-PSU Distance&quot;</span>,</span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Distance&quot;</span>,</span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;Frequency&quot;</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" style="display: block; margin: auto auto auto 0;" /></p>
<p>The plot shows the PSU cluster centroids. As can be seen, a vague
outline of the United States is visible, with Alaska in the upper left
and Hawaii in the lower left. The section on displaying United States
geography-based PSUs shows how to add a political map to this.</p>
<p>The histogram provides a bar chart of the maximum within-PSU
distance. As can be seen, no PSU contains a maximum distance of more
than 100 miles. In this data set, there are many PSUs with a maximum
distance of zero miles. This is because the geography-based sampling
unit in the PSU was more than 100 miles from its next nearest
geography-based sampling unit; it becomes its own PSU under the distance
rules.</p>
<p>While GeoDistPSU creates PSUs with a maximum distance, the function
does not address measure of size. For a pps sample design, some PSUs may
need to be split to create a more even distribution of MOS across the
PSUs. Here, the PSU ID is added to the Test_Data_US from the GeoDistPSU
output and then input into GeoDistMOS. Letâs assume the sample size is
15 and the take-all threshold is 0.80. The code is:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a><span class="do">## Add PSU from GeoDistPSU</span></span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>Test_Data_US<span class="sc">$</span>psuID <span class="ot">&lt;-</span> g<span class="sc">$</span>PSU.ID<span class="sc">$</span>psuID</span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a><span class="do">## Update GeoDistPSUs for a threshold measure of size of 0.80</span></span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">GeoDistMOS</span>(<span class="at">lat =</span> Test_Data_US<span class="sc">$</span>lat, <span class="at">long =</span> Test_Data_US<span class="sc">$</span>long, <span class="at">psuID =</span> Test_Data_US<span class="sc">$</span>psuID, <span class="at">n =</span> <span class="dv">15</span>, <span class="at">MOS.var =</span> Test_Data_US<span class="sc">$</span>Amount, <span class="at">MOS.takeall =</span> <span class="fl">0.80</span>, <span class="at">Input.ID =</span> Test_Data_US<span class="sc">$</span>ID)</span></code></pre></div>
<p>Note that the sample size of PSUs, n=15, may be a preliminary value
used in the computation to identify certainties. The final sample size
may be determined after computing relvariance components using the PSUs
that are formed with GeoDistPSU or GeoDistMOS as illustrated later in
the vignette.</p>
<p>The list object created by GeoDistMOS contains two data frames. The
first data frame, PSU.ID.Max.MOS contains the original PSU ID for the
geographic sampling units, their new PSU ID based on the maximum measure
of size threshold, and the Input ID for merging to the original data
file.</p>
<p>The second data frame, PSU.Max.MOS.Info, contains the information on
the updated PSU ID given the MOS threshold, the inclusion probability
for the updated PSU ID given the sample size used for GeoDistMOS, and
the number of SSUs in each PSU. The inclusion probabilities can be shown
in a histogram to assess of the distribution of the MOS values. Râs
descriptive functions like summary() and var() also give useful
statistics. For example, if the variance of the MOS is zero, PSUs all
have the same size.</p>
<p>A histogram of the MOS for the updated PSUs can be generated with the
following code:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a><span class="fu">hist</span>(m<span class="sc">$</span>PSU.Max.MOS.Info<span class="sc">$</span>psuID.prob,</span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>       <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.05</span>), </span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a>       <span class="at">main =</span> <span class="st">&quot;Histogram of PSU Inclusion Probabilities (Certainties = 1)&quot;</span>,</span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a>       <span class="at">xlab =</span> <span class="st">&quot;Inclusion Probability&quot;</span>,</span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a>       <span class="at">ylab =</span> <span class="st">&quot;Frequency&quot;</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" style="display: block; margin: auto auto auto 0;" /></p>
<p>This histogram allows the survey practitioner to see how evenly sized
the PSUs are. The constraint of the maximum travel distance being 100
miles within each PSU limits shows how well the âevenly sizedâ goal can
be met. Here, while slightly over two thirds of the MOS are less than
0.10, there is something of a tail that the survey practitioner might
want to consider. As an aside, the default for hist() bars is a
left-open, right-closed interval. In this histogram, all certainties
equal to 1 are in the bar between 0.95 and 1.00. For other approaches to
displaying the inclusion probabilities, the reader is referred to ggplot
vignettes.</p>
</div>
<div id="displaying-geography-based-psus" class="section level2">
<h2>Displaying Geography-Based PSUs</h2>
<p>The output from GeoDistPSU is a list. Mapping in R almost always
requires a data frame. The R package usmap can be used to overlay the
United States political boundaries on the PSU centroids. The usmap
package requires that the longitude and latitude coordinates of the
centroids be in a data frame which is then transformed by application of
the Albers Equal Area projection. The code is below. (Uncomment the code
to run it.)</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="co">#library(sp)</span></span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a><span class="co">#library(usmap)</span></span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a><span class="co">#library(ggplot2)</span></span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a><span class="do">## Transform PSUs into usmap projection</span></span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a><span class="co">#g.map  &lt;- cbind(long = g$PSU.Info$PSU.Mean.Longitude, </span></span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a><span class="co">#          lat  = g$PSU.Info$PSU.Mean.Latitude) </span></span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a><span class="co">#g.map  &lt;- as.data.frame(g.map)</span></span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a><span class="co">#g.proj &lt;- usmap::usmap_transform(g.map,</span></span>
<span id="cb6-9"><a href="#cb6-9" tabindex="-1"></a><span class="co">#             input_names  = c(&quot;long&quot;, &quot;lat&quot;),</span></span>
<span id="cb6-10"><a href="#cb6-10" tabindex="-1"></a><span class="co">#             output_names = c(&quot;Long&quot;, &quot;Lat&quot;))</span></span>
<span id="cb6-11"><a href="#cb6-11" tabindex="-1"></a><span class="co">#plot_usmap(color = &quot;gray&quot;) +</span></span>
<span id="cb6-12"><a href="#cb6-12" tabindex="-1"></a><span class="co">#        geom_point(data = g.proj, aes(x = Long, y = Lat))</span></span></code></pre></div>
<div class="float">
<img role="img" aria-label="US map with PSUs" src="data:image/png;base64,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" alt="US map with PSUs" />
<div class="figcaption">US map with PSUs</div>
</div>
<p>As can be seen, this code gives the survey practitioner working with
United States geographic sampling units to immediately identify where
the PSUs are. For additional improvements on the plot, such as labels,
the reader is referred to ggplot vignettes.</p>
</div>
<div id="geography-based-psus-and-two-stage-sample-size-calculations" class="section level2">
<h2>Geography-Based PSUs and Two-Stage Sample Size Calculations</h2>
<p>PracTools comes with two functions that are helpful with two-stage
sample size calculations: BW2stageSRS and BW2stagePPS. BW2stageSRS
computes the relvariance components for a two-stage sample where both
PSUs and elements within PSUs, or Secondary Sampling Units (SSUs), are
selected via simple random sample (SRS). BW2stagePPS computes the
relvariance components for a two-stage sample where the PSUs are
selected with probabilities proportional to size (PPS) and the SSUs are
selected via simple random sample. Both functions require that an entire
sampling frame be used as input. The values from these functions can be
used to optimize the number of first-stage and second-stage sample
units. This section reviews these two functions based on the output from
GeoDistPSU, and then again with the output from GeoDistMOS. As the
primary sampling unit ID, we use the field PSU, which was appended to
Test_Data_US above.</p>
<p>To understand what BW2stageSRS and BW2stagePPS are doing, we can
examine the formula for the relvariance of an estimator of total.
Suppose that <span class="math inline">\(\small m\)</span> is the number
of sample PSUs and that the same number of SSUs, <span class="math inline">\(\small \bar{n}\)</span>, is selected in each
sample PSU. The approximate relvariance of an estimator of a total with
either SRS at both stages or pps at the first stage and SRS at the
second can be written as:</p>
<span class="math display">\[\begin{equation}
\small \frac{V(\hat{t}_{\pi})}{t^2_U} = \frac{B^2}{m} +
\frac{W^2}{m\bar{n}} = \frac{\tilde{V}}{m\bar{n}}k[1 + \delta(\bar{n} -
1)]\;.
\end{equation}\]</span>
<p>where <span class="math inline">\(\small B^2\)</span> is the
between-PSU sum of squares and <span class="math inline">\(\small
W^2\)</span> is the within-PSU sum of squares. <span class="math inline">\(\small \tilde{V}\)</span> is the unit relvariance
of the analysis variable, <span class="math inline">\(\small \delta =
B^2/(B^2 + W^2)\)</span>, and <span class="math inline">\(\small k =
(B^2+W^2)/\tilde{V}\)</span>. The equation above applies when the
sampling fractions are negligible at both stages. See <span class="citation">Valliant, Dever, and Kreuter (2018)</span>, sections
9.2.1 and 9.2.3 for details.</p>
<p>In preparing data for the BW2stageSRS and BW2stagePPS, it is
important to consider which variable is used for the relvariance
calculations in a two-stage sample. Test_Data_US$Y is used in this
example, but different analysis variables will have different
components. For BW2stagePPS, the inclusion probabilities are also
necessary.</p>
<p>GeoDistPSU creates PSUs so that the maximum travel distance within a
PSU is constrained without considering any measure of size associated
with the input units. After adding the PSU from GeoDistPSU to the data
frame (code shown above), the code for BW2stageSRS is:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a></span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a><span class="fu">BW2stageSRS</span>(<span class="at">X =</span> Test_Data_US<span class="sc">$</span>Y, <span class="at">psuID =</span> Test_Data_US<span class="sc">$</span>psuID, <span class="at">lonely.SSU =</span> <span class="st">&quot;zero&quot;</span>)</span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a><span class="co">#&gt;          B2          W2 unit relvar       B2+W2           k       delta </span></span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a><span class="co">#&gt;   2.0201042   3.3777276   1.4277924   5.3978318   3.7805439   0.3742436</span></span></code></pre></div>
<p>To perform the calculations using BW2stagePPS, it is necessary to
have a vector of 1-draw inclusion probabilities for the PSUs, i.e., the
selection probability of each PSU in a sample of size 1. <em>This vector
must sum to 1.</em> For the MOS variable, we use the field, Amount, in
Test_Data_US. Thus, this example illustrates the effects of selecting
the PSU sample with probabilities proportional to Amount and computing
relvariance components for Y. The code for BW2stagePPS, using the PSUs
created by GeoDistPSU, is:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a></span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>pp <span class="ot">&lt;-</span> <span class="fu">tapply</span>(Test_Data_US<span class="sc">$</span>Amount, Test_Data_US<span class="sc">$</span>psuID, sum)<span class="sc">/</span><span class="fu">sum</span>(Test_Data_US<span class="sc">$</span>Amount)</span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a><span class="fu">BW2stagePPS</span>(<span class="at">X =</span> Test_Data_US<span class="sc">$</span>Y, <span class="at">pp =</span> pp, <span class="at">psuID =</span> Test_Data_US<span class="sc">$</span>psuID, <span class="at">lonely.SSU =</span> <span class="st">&quot;zero&quot;</span>)</span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a><span class="co">#&gt;          B2          W2 unit relvar       B2+W2           k       delta </span></span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a><span class="co">#&gt;   0.5450555   0.9638436   1.4277924   1.5088991   1.0568057   0.3612273</span></span></code></pre></div>
<p>Delta is a within-PSU measure of homogeneity and is defined as the
between sum of squares divided by the sum of the between sum of squares
and the within sum of squares; as noted above, <span class="math inline">\(\small \delta = B^2/(B^2 + W^2)\)</span>. The
closer the MOS is to be being proportional to the variable of interest
being collected in the sample, the smaller <span class="math inline">\(\small B^2\)</span> will be in a PPS sample. The
extreme case of <span class="math inline">\(\small \delta\)</span> near
zero implies only one PSU needs to be sampled as each PSU is
statistically identical. In this example, the delta values are similar
for both SRS and PPS, although that will often not be the case.</p>
<p>The term <span class="math inline">\(\small k\)</span> is the ratio
of <span class="math inline">\(\small B^2+W^2\)</span> to the unit
relvariance of Y. If <span class="math inline">\(\small k\)</span> is
close to 1, then there is not much variation in the size of the
secondary sampling units within each PSU. In fact, the variance formula
for a single-stage cluster sample assumes <span class="math inline">\(\small k = 1\)</span>. However, if <span class="math inline">\(\small k\)</span> is not close to 1, then the
survey estimates in a two-stage SRS sample may not be very precise for
some variables where the PSUs vary in size. As can be seen from the
equation for the relvariance of an estimated total above, the lower
<span class="math inline">\(\small k\)</span> for BW2stagePPS suggests
PPS sampling may be preferred even though the <span class="math inline">\(\small \delta\)</span>âs in SRS and PPS are about
the same.</p>
<p>The output from GeoDistMOS, which evens out the PSU MOS sizes to the
extent feasible, may provide additional information. This is because
creating clusters of equal sizes should be performed, if possible. Large
variations in PSU sizes is likely to result in large variations in the
PSU estimated totals. Large variations in the estimated PSU totals in
turn lead to a high between sum of squares relative to the within sum of
squares. This in turn leads to a high measure of PSU homogeneity and a
less efficient two-stage sample.</p>
<p>Combining the output from the PSU.ID.Max.MOS data frame with the
original data frame can be done by merging on the Input.ID field.
GeoDistPSU and GeoDistMOS output the ID field as a character. In this
example, the original ID field is numeric. To combine:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a></span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a>Test_Data_US <span class="ot">&lt;-</span> Test_Data_US <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">ID =</span> <span class="fu">as.character</span>(ID))</span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a>Test_Data_US <span class="ot">&lt;-</span> <span class="fu">inner_join</span>(Test_Data_US, m<span class="sc">$</span>PSU.ID.Max.MOS, <span class="at">by=</span><span class="fu">c</span>(<span class="st">&quot;ID&quot;</span> <span class="ot">=</span> <span class="st">&quot;Input.ID&quot;</span>))</span></code></pre></div>
<p>With the geographic data frame updated for a more equal measure of
size by GeoDistMOS, re-running the above returns:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a></span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a><span class="fu">BW2stageSRS</span>(<span class="at">X =</span> Test_Data_US<span class="sc">$</span>Y, <span class="at">psuID =</span> Test_Data_US<span class="sc">$</span>psuID.new, <span class="at">lonely.SSU =</span> <span class="st">&quot;zero&quot;</span>)</span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a><span class="co">#&gt;          B2          W2 unit relvar       B2+W2           k       delta </span></span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a><span class="co">#&gt;   1.4712848   1.8843484   1.4277924   3.3556331   2.3502249   0.4384522</span></span></code></pre></div>
<p>We can also compute components with the PSUs created by GeoDistMOS
but assuming that PSUs are selected via PPS. We first note that two of
the PSUs formed by GeoDistMOS will be certainties since their values of
m$PSU.Max.MOS.Info$psuID.prob is approximately 1. These PSUs can be
identified with this code:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a></span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>certs <span class="ot">&lt;-</span> (<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(m<span class="sc">$</span>PSU.Max.MOS.Info))[m<span class="sc">$</span>PSU.Max.MOS.Info<span class="sc">$</span>psuID.prob <span class="sc">&gt;</span> <span class="fl">0.8</span>]</span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a>certID <span class="ot">&lt;-</span> m<span class="sc">$</span>PSU.Max.MOS.Info[certs, <span class="st">&quot;psuID.new&quot;</span>]</span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a>certID</span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a><span class="co">#&gt; [1] &quot;1.1&quot; &quot;2.1&quot;</span></span></code></pre></div>
<p>The certainties have psuID.newâs of 1.1 and 2.1. Because a PSU
selected with probability 1 will not contribute to the <span class="math inline">\(\small B^2\)</span> component of variance, we
exclude them before calling BW2stagePPS. This is done by creating a
subset of the data containing only the non-certainty PSUs, and the
corresponding subset of the weights.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="do">## Create vector of 1-draw probabilities</span></span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>pp <span class="ot">&lt;-</span> <span class="fu">tapply</span>(Test_Data_US<span class="sc">$</span>Amount, Test_Data_US<span class="sc">$</span>psuID.new, sum)<span class="sc">/</span><span class="fu">sum</span>(Test_Data_US<span class="sc">$</span>Amount)</span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a><span class="do">## Subset Test_Data_US for non-certainties</span></span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a>sub.Test_Data_US <span class="ot">&lt;-</span> Test_Data_US[<span class="sc">!</span>(Test_Data_US<span class="sc">$</span>psuID.new <span class="sc">%in%</span> certID),]</span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a><span class="do">## Subset vector of 1-draw probabilities for non-certainties</span></span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a>sub.pp <span class="ot">&lt;-</span> pp[<span class="sc">-</span>certs]</span></code></pre></div>
<p>Note that in this step, by removing the certainties and their
corresponding 1-draw probabilities, the sum of the sub.pp is now less
than 1. (In fact, in this example the sum of sub.pp = 0.7829797). As
stated above, the vector of 1-draw probabilities in the pp= parameter
must equal 1. Accordingly, the 1-draw probabilities for the
non-certainties need to be rescaled to total 1.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="do">## Rescale sub.pp to sum to 1</span></span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a>sub.pp <span class="ot">&lt;-</span> sub.pp<span class="sc">/</span><span class="fu">sum</span>(sub.pp)</span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a><span class="fu">BW2stagePPS</span>(<span class="at">X =</span> sub.Test_Data_US<span class="sc">$</span>Y, <span class="at">pp =</span> sub.pp, <span class="at">psuID =</span> sub.Test_Data_US<span class="sc">$</span>psuID.new, </span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a>            <span class="at">lonely.SSU =</span> <span class="st">&quot;zero&quot;</span>)</span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a><span class="co">#&gt;          B2          W2 unit relvar       B2+W2           k       delta </span></span>
<span id="cb13-6"><a href="#cb13-6" tabindex="-1"></a><span class="co">#&gt;   0.4648113   0.7540973   1.1043456   1.2189086   1.1037384   0.3813340</span></span></code></pre></div>
<p>As can be seen, making the clusters more evenly sized increases the
delta slightly. For the data here, it does seem that a first-stage PPS
sample is the better approach based on its k-value being close to 1, and
that evening the size of the MOS does increase heterogeneity in the
sampling frame. Finally, to optimize the sample sizes at each stage in a
two-stage sample design, the reader is referred to
PracTools::clusOpt2.</p>
</div>
<div id="references" class="section level2 unnumbered">
<h2 class="unnumbered">References</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-tidygeocoder.2021" class="csl-entry">
Cambon, J., D. Hernangomez, C. Belanger, and D. Possenriede. 2021.
<em>Tidygeocoder: An <span>R</span> Package for Geocoding</em>. <a href="https://CRAN.R-project.org/package=tidygeocoder">https://CRAN.R-project.org/package=tidygeocoder</a>.
</div>
<div id="ref-VDK.2018" class="csl-entry">
Valliant, R., J. A. Dever, and F. Kreuter. 2018. <em>Practical Tools for
Designing and Weighting Survey Samples</em>. 2nd ed. New York:
Springer-Verlag.
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
